<?php

namespace App\Support;

class KraepelinTemplate
{
    /**
     * MATRIX berisi 28 baris × 50 kolom.
     * Baris 0 = PALING BAWAH, baris 27 = PALING ATAS.
     *
     * Satu baris = satu “baris horizontal” di form Excel.
     */
    public const MATRIX = [
        // row 1 (PALING BAWAH)
        [2,7,2,5,9,5,9,5,3,6,
         3,6,5,5,1,4,1,5,1,2,
         0,6,6,6,1,0,9,9,6,1,
         4,4,3,9,9,5,9,9,7,9,
         2,1,2,8,9,7,9,2,1,2],

        // row 2
        [9,3,4,4,9,9,9,9,9,6,
         3,3,2,2,2,5,6,2,2,6,
         5,6,2,7,2,4,5,7,4,2,
         8,8,4,9,9,9,4,3,8,5,
         6,6,6,1,3,8,5,6,6,6],

        // row 3
        [9,1,4,8,4,3,4,3,2,2,
         2,5,7,0,4,2,4,0,4,3,
         2,4,8,4,7,0,4,2,7,9,
         5,6,8,4,4,3,8,4,1,0,
         6,2,7,2,4,1,0,6,2,7],

        // row 4
        [7,6,4,5,8,4,8,4,7,0,
         4,2,7,9,5,6,8,9,5,7,
         0,5,5,5,7,9,5,6,8,5,
         9,9,5,8,8,4,5,5,6,7,
         4,2,8,8,5,6,7,4,2,8],

        // row 5
        [5,5,7,9,5,5,5,5,7,9,
         5,6,8,5,9,9,5,9,9,7,
         9,2,1,2,8,5,9,9,1,0,
         9,9,9,1,2,4,5,7,0,7,
         5,1,1,2,7,0,7,5,1,1],

        // row 6
        [4,4,7,3,1,2,1,2,8,5,
         9,9,1,0,9,9,9,4,3,8,
         5,6,6,6,1,0,9,9,6,1,
         4,4,3,5,5,1,9,7,9,8,
         0,4,5,5,7,9,8,0,4,5],

        // row 7
        [8,3,6,3,6,6,6,6,1,0,
         9,9,6,1,4,4,3,8,4,1,
         0,6,2,7,2,4,5,7,4,2,
         8,8,4,2,0,4,3,8,5,1,
         5,1,2,0,8,5,1,5,1,2],

        // row 8
        [7,9,6,3,3,6,2,7,2,4,
         5,7,4,2,8,8,4,5,5,6,
         7,4,2,8,8,4,5,5,6,9,
         9,9,2,6,5,1,4,1,0,2,
         4,2,2,2,1,0,2,4,2,2],

        // row 9
        [8,7,9,6,9,6,4,3,5,1,
         9,7,5,1,1,2,4,5,7,0,
         7,5,1,1,2,4,5,7,0,4,
         4,3,4,3,2,2,5,6,1,4,
         5,7,0,4,6,1,4,5,7,0],

        // row 10
        [2,8,5,8,7,9,1,4,0,4,
         3,8,0,4,5,5,1,9,7,9,
         8,0,4,5,5,1,9,7,9,8,
         8,4,5,7,0,4,2,4,2,1,
         9,7,9,5,4,2,1,9,7,9],

        // row 11
        [6,4,2,5,8,5,2,5,5,1,
         4,1,5,1,2,0,4,3,8,5,
         1,5,1,2,0,4,3,8,5,5,
         6,1,4,9,9,7,9,5,6,8,
         4,5,5,5,8,4,4,3,8,5],

        // row 12
        [5,2,4,4,4,2,4,2,2,2,
         5,6,2,2,6,5,1,4,1,0,
         2,4,2,2,2,5,6,2,2,2,
         4,2,8,4,3,8,5,9,9,5,
         1,2,2,0,5,1,1,4,1,0],

        // row 13
        [4,5,1,1,2,4,5,7,0,4,
         2,4,0,4,3,2,2,5,6,1,
         4,5,7,0,4,2,4,0,4,6,
         8,4,5,8,4,1,0,9,9,9,
         2,6,6,5,9,2,2,5,6,1],

        // row 14
        [8,0,4,5,5,1,9,7,9,5,
         6,8,9,5,7,0,4,2,4,2,
         1,9,7,9,5,6,8,9,5,9,
         5,1,2,5,5,6,1,4,4,3,
         4,3,3,2,3,4,4,2,4,2],

        // row 15
        [5,5,1,2,0,4,3,8,5,9,
         9,5,9,9,7,9,5,6,8,4,
         4,3,8,5,9,9,5,9,9,9,
         9,2,6,1,2,4,2,8,8,4,
         5,7,7,0,4,5,5,6,8,4],

        // row 16
        [2,2,2,6,5,1,4,1,0,9,
         9,9,4,3,8,5,9,9,5,1,
         1,4,1,0,9,9,9,4,3,8,
         5,9,9,5,2,2,5,6,2,2,
         6,5,1,9,9,9,0,4,2,4],

        // row 17
        [4,0,4,3,2,2,5,6,1,4,
         4,3,8,4,1,0,9,9,9,2,
         2,5,6,1,4,4,3,8,4,1,
         0,9,9,9,0,4,2,4,0,4,
         3,2,2,4,4,3,9,5,6,8],

        // row 18
        [5,9,5,7,0,4,2,4,2,8,
         8,4,5,5,6,1,4,4,3,4,
         4,2,4,2,8,8,4,5,5,6,
         1,4,4,3,9,5,6,8,9,5,
         7,0,4,8,8,4,5,9,9,5],

        // row 19
        [0,9,9,7,9,5,6,8,4,5,
         5,1,1,2,4,2,8,8,4,5,
         5,6,8,4,5,5,1,1,2,4,
         2,8,8,4,5,9,9,5,9,9,
         7,9,5,1,2,4,0,9,9,9],

        // row 20
        [1,4,3,8,5,9,9,5,1,2,
         0,4,4,3,2,2,5,6,1,4,
         9,9,7,9,5,6,8,4,5,5,
         1,1,2,4,0,9,9,9,4,3,
         8,5,9,4,3,2,1,4,4,3],

        // row 21
        [2,8,4,1,0,9,9,9,2,6,
         5,1,5,7,0,4,2,4,2,8,
         4,3,8,5,9,9,5,1,2,0,
         4,4,3,2,1,4,4,3,8,4,
         1,0,9,5,7,0,2,8,8,4],

        // row 22
        [5,5,5,6,1,4,4,3,4,3,
         2,2,9,7,9,5,6,8,4,5,
         8,4,1,0,9,9,9,2,6,5,
         1,5,7,0,2,8,8,4,5,5,
         6,1,4,6,5,1,5,7,0,2],

        // row 23
        [6,1,2,4,2,8,8,4,5,7,
         0,4,3,8,5,9,9,5,1,2,
         5,5,6,1,4,4,3,4,3,2,
         2,9,7,9,4,5,5,1,1,2,
         4,2,8,3,2,2,9,7,9,4],

        // row 24
        [5,6,6,8,5,5,5,5,9,7,
         9,5,4,1,0,9,9,9,2,6,
         1,2,4,2,8,8,4,5,7,0,
         4,3,8,5,1,2,0,4,4,3,
         2,2,5,7,0,4,3,8,5,1],

        // row 25
        [9,2,7,2,6,1,1,2,3,8,
         5,9,5,6,1,4,4,3,4,3,
         6,6,8,5,5,5,5,9,7,9,
         5,4,1,0,2,6,5,1,5,7,
         0,4,2,7,9,5,4,1,0,2],

        // row 26
        [7,4,4,6,5,6,6,6,4,1,
         0,9,2,4,2,8,8,4,5,7,
         2,7,2,6,1,1,2,3,8,5,
         9,5,6,1,4,3,2,2,9,7,
         9,5,6,8,5,9,5,6,1,4],

        // row 27
        [7,8,5,5,9,2,2,7,5,6,
         1,4,6,8,5,5,5,5,9,7,
         4,4,6,5,6,6,6,4,1,0,
         9,2,4,2,5,7,0,4,3,8,
         5,9,9,1,0,9,2,4,2,5],

        // row 28 (PALING ATAS)
        [2,5,8,8,7,4,4,4,2,4,
         2,8,7,2,6,1,1,2,3,8,
         8,5,5,9,2,2,7,5,6,1,
         4,6,8,5,9,7,9,5,4,1,
         0,9,9,6,1,4,6,8,5,9],
    ];

    public static function validate(): void
    {
        $rows = count(self::MATRIX);
        if ($rows !== 28) {
            throw new \RuntimeException("Template harus 28 baris, sekarang: {$rows}");
        }

        foreach (self::MATRIX as $i => $row) {
            $cols = count($row);
            if ($cols !== 50) {
                throw new \RuntimeException(
                    "Baris " . ($i + 1) . " harus 50 angka, sekarang: {$cols}"
                );
            }
        }
    }

    public static function getColumnChain(int $colIndex): array
    {
        // colIndex: 1..50
        $col = $colIndex - 1;

        // LANGSUNG saja, TANPA array_reverse,
        // karena MATRIX sudah kamu isi dari bawah → atas.
        return array_column(self::MATRIX, $col);
    }

}
